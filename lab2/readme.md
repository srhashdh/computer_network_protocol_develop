battle request have problem maybe use pthread_join?